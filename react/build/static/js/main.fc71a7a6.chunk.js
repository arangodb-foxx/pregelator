(this.webpackJsonppregelator=this.webpackJsonppregelator||[]).push([[0],{137:function(e,t,a){e.exports=a(341)},340:function(e,t,a){},341:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(11),o=a.n(l),c=a(7),i=a(17),u=a(343),s=a(364),d=a(359),m=a(365),p=a(361),f=a(366),b=a(360),h=a(362),g=a(19),E=(a(158),Object(n.createContext)()),j=function(e){var t=Object(n.useState)({}),a=Object(c.a)(t,2),l=a[0],o=a[1];return r.a.createElement(E.Provider,{value:[l,o]},e.children)},v=function(){return Object(n.useContext)(E)},O=Object(n.createContext)(),y=function(e){var t=Object(n.useState)({}),a=Object(c.a)(t,2),l=a[0],o=a[1];return r.a.createElement(O.Provider,{value:[l,o]},e.children)},x=Object(n.createContext)(),k=function(e){var t=Object(n.useState)([]),a=Object(c.a)(t,2),l=a[0],o=a[1];return Object(n.useEffect)((function(){Object(i.get)("graphs").then((function(e){return o(e.data)}))}),[]),r.a.createElement(x.Provider,{value:[l,o]},e.children)},w=a(27),S=a.n(w),C=a(47),B=a(28),P=a(367),R=a(368),z=a(363),N=a(6),F=function(e){for(var t=[],a=0,n=Object.entries(e);a<n.length;a++){var r=Object(c.a)(n[a],2)[1];"running"===r.state&&t.push(r)}return t},I=function(e){for(var t=[],a=0,n=Object.entries(e);a<n.length;a++){var r=Object(c.a)(n[a],2)[1];"done"===r.state&&t.push(r)}return t},T=function(){var e=v(),t=Object(c.a)(e,2)[1],a=Object(n.useContext)(O),l=Object(c.a)(a,2),o=l[0],s=l[1],d=function(){var e=Object(C.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s({});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(u.a,{width:"full"},r.a.createElement(N.Button,{primary:!0,label:"Clear",alignSelf:"end",onClick:d})),r.a.createElement(P.a,{level:"3"},"Running (",Object.keys(F(o)).length,")"),r.a.createElement(u.a,null,0===Object.keys(F(o)).length&&r.a.createElement(R.a,null,"No pregel algorithm started yet."),Object.keys(F(o)).length>0&&r.a.createElement(z.a,{columns:[{property:"pid",header:r.a.createElement(R.a,null,"ID"),primary:!0},{property:"percent",header:"Result field",render:function(e){return r.a.createElement(u.a,null,r.a.createElement(R.a,null,e.resultField))}}],data:F(o)})),r.a.createElement(P.a,{level:"3"},"Done (",Object.keys(I(o)).length,")"),r.a.createElement(u.a,null,0===Object.keys(I(o)).length&&r.a.createElement(R.a,null,"No pregel algorithm finished yet."),Object.keys(I(o)).length>0&&r.a.createElement(z.a,{columns:[{property:"pid",header:r.a.createElement(R.a,null,"ID")},{property:"percent",header:"Execution time",render:function(e){return r.a.createElement(u.a,null,r.a.createElement(R.a,null,e.totalRuntime))}}],onClickRow:function(e){var a;a=e.datum,Object(g.b)("Fetching status now of pid: ".concat(a.pid)),Object(i.post)("status",{pid:a.pid},{headers:{"Content-Type":"application/json"}}).then((function(e){e.data&&"done"===e.data.state&&Object(i.post)("resultDetails",{graphName:a.selectedGraph,resultField:a.resultField},{headers:{"Content-Type":"application/json"}}).then((function(n){if(n.data){var r=[];if(e.data.reports&&e.data.reports.length>=0){for(var l=0,o=Object.entries(e.data.reports);l<o.length;l++){var i=Object(c.a)(o[l],2)[1];r.push(i)}r=e.data.reports,delete e.data.reports}var u={summary:e.data,preview:n.data,reports:r};u.summary.pid=a.pid,t((function(e){return Object(B.a)({},u)}))}}))}))},data:I(o)})))},D=function(){var e=Object(n.useContext)(O),t=Object(c.a)(e,1)[0];return r.a.createElement("div",null,r.a.createElement(N.Heading,{level:"4",margin:"none"},"Pregelator"),r.a.createElement(N.Heading,{level:"6",margin:"none"},"Executed algorithms: ",Object.keys(t).length))},J=a(55),V=a.n(J),G=(a(337),a(338),a(339),a(340),Object(n.createContext)()),W=function(e){var t=Object(n.useState)({}),a=Object(c.a)(t,2),l=a[0],o=a[1];return Object(n.useEffect)((function(){Object(i.get)("userDefinedAlgorithms").then((function(e){o(e.data)}))}),[]),r.a.createElement(G.Provider,{value:[l,o]},e.children)},A=function(e){return r.a.createElement(N.Box,Object.assign({direction:"row",align:"center",background:"dark-1",pad:{left:"small",right:"small",vertical:"small"},elevation:"medium",style:{zIndex:"1"}},e))},$=r.a.createRef(),K=r.a.createRef(),L=r.a.createRef();var H=function(){!function(e,t){var a=Object(n.useRef)();Object(n.useEffect)((function(){a.current=e}),[e]),Object(n.useEffect)((function(){if(null!==t){var e=setInterval((function(){a.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){!function(e){for(var t=function(){var e=Object(c.a)(n[a],2)[1];"running"===e.state&&Object(i.post)("status",{pid:e.pid},{headers:{"Content-Type":"application/json"}}).then((function(t){t.data&&"done"===t.data.state&&(m((function(a){var n=a;return n[e.pid].state=t.data.state,n[e.pid].totalRuntime=t.data.totalRuntime.toFixed(5),Object(B.a)({},n)})),F(e))}))},a=0,n=Object.entries(e);a<n.length;a++)t();var r=K.current.editor.getCursorPosition(),l=L.current.editor.getCursorPosition(),o="";b.summary&&(o=JSON.stringify(b.summary,null,2));var u="";b.preview&&(u=JSON.stringify(b.preview,null,2)),K.current.editor.getValue()!==o&&K.current.editor.setValue(o,r),L.current.editor.getValue()!==u&&L.current.editor.setValue(u,l)}(d)}),1e3);var e=function(){var e=Object(C.a)(S.a.mark((function e(){var t,a,n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=(t=$.current.editor.getValue()).replace(/\s*\/\/.*\n/g,"\n").replace(/\s*\/\*[\s\S]*?\*\//g,""),!("resultField"in(t=JSON.parse(t)))){e.next=8;break}a=t.resultField,e.next=10;break;case 8:return g.b.error("Attribute resultField is missing!"),e.abrupt("return");case 10:if(y){e.next=13;break}return g.b.error("No SmartGraph selected!"),e.abrupt("return");case 13:return e.next=15,Object(i.post)("start",{name:"AIR",graphName:y,algorithm:t},{headers:{"Content-Type":"application/json"}});case 15:n=e.sent,m((function(e){var t=e;return t[n.data.pid]={pid:n.data.pid,totalRuntime:null,resultField:a,selectedGraph:y,state:"running"},Object(B.a)({},t)})),r="Pregel started, PID: "+n.data.pid,Object(g.b)(r),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(0),console.log(e.t0),g.b.error("Parse error!");case 24:case"end":return e.stop()}var r}),e,null,[[0,20]])})));return function(){return e.apply(this,arguments)}}(),t=Object(n.useContext)(x),a=Object(c.a)(t,1)[0],l=Object(n.useContext)(G),o=Object(c.a)(l,1)[0],u=Object(n.useContext)(O),s=Object(c.a)(u,2),d=s[0],m=s[1],p=v(),f=Object(c.a)(p,2),b=f[0],h=f[1],E=Object(n.useState)(null),j=Object(c.a)(E,2),y=j[0],k=j[1],w=Object(n.useState)(null),P=Object(c.a)(w,2),R=P[0],z=P[1],F=function(e){Object(g.b)("Fetching status now of pid: ".concat(e.pid)),Object(i.post)("status",{pid:e.pid},{headers:{"Content-Type":"application/json"}}).then((function(t){t.data&&"done"===t.data.state&&Object(i.post)("resultDetails",{graphName:e.selectedGraph,resultField:e.resultField},{headers:{"Content-Type":"application/json"}}).then((function(a){if(a.data){var n=[];if(t.data.reports&&t.data.reports.length>=0){for(var r=0,l=Object.entries(t.data.reports);r<l.length;r++){var o=Object(c.a)(l[r],2)[1];n.push(o)}n=t.data.reports,delete t.data.reports}var i={summary:t.data,preview:a.data,reports:n};i.summary.pid=e.pid,h((function(e){return Object(B.a)({},i)}))}}))}))};return r.a.createElement(N.Box,{direction:"column",flex:"grow",fill:"horizontal"},r.a.createElement(A,null,r.a.createElement(N.Select,{options:Object.keys(o),margin:{right:"small"},placeholder:"Select Algorithm",onChange:function(e){!function(e){z(e);var t="";try{t=o[e].algorithm,$.current.editor.setValue(JSON.stringify(t,null,2),-1)}catch(a){Object(g.b)("Something went wrong: ".concat(a))}}(e.option)}}),r.a.createElement(N.Select,{options:a,placeholder:"Select SmartGraph",value:y,onChange:function(e){var t=e.option;k(t)}}),r.a.createElement(N.Button,{primary:!0,label:"Execute",margin:{left:"small"},onClick:e})),r.a.createElement(N.Box,{direction:"row",fill:"vertical"},r.a.createElement(N.Box,{flex:!0},r.a.createElement(V.a,{ref:$,value:function(){if(R){var e="";try{e=o[R].algorithm}catch(t){Object(g.b)("Error: "+t)}return JSON.stringify(e,null,2)}return JSON.stringify({},null,2)}(),mode:"json",width:"full",height:"100%",theme:"monokai",commands:[],name:"aceInputEditor",setOptions:{useWorker:!1},editorProps:{$blockScrolling:!0}})),r.a.createElement(N.Box,{flex:!0,direction:"column"},r.a.createElement(N.Box,{flex:!0,direction:"row",width:"full",height:"small"},r.a.createElement(N.Box,{basis:"1/2",background:"dark-1"},r.a.createElement(N.Box,{background:"brand"},r.a.createElement(N.Text,{margin:"xsmall",weight:"bold"},"Summary")),r.a.createElement(V.a,{ref:K,readOnly:!0,value:"",mode:"json",width:"full",height:"100%",theme:"monokai",name:"aceSummaryEditor",setOptions:{useWorker:!1},editorProps:{$blockScrolling:!0}})),r.a.createElement(N.Box,{basis:"1/2",background:"dark-1"},r.a.createElement(N.Box,{background:"brand"},r.a.createElement(N.Text,{margin:"xsmall",weight:"bold"},"Preview")),r.a.createElement(V.a,{ref:L,value:"",readOnly:!0,mode:"json",width:"full",height:"100%",theme:"monokai",name:"aceSummaryEditor",setOptions:{useWorker:!1},editorProps:{$blockScrolling:!0}}))),r.a.createElement(N.Box,{background:"brand"},r.a.createElement(N.Text,{margin:"xsmall",weight:"bold"},"Reports")),r.a.createElement(N.Box,{basis:"2/3",overflow:"scroll",background:"dark-1"},r.a.createElement(N.DataTable,{resizeable:!1,size:"full",alignSelf:"stretch",primaryKey:!1,columns:[{property:"msg",header:"Message",size:"medium",render:function(e){return r.a.createElement(N.Paragraph,{size:"small"},e.msg)}},{property:"vertex",header:"Vertex",size:"small",render:function(e){return r.a.createElement(N.Box,null,r.a.createElement(N.Text,{size:"small"},e.annotations.vertex))}},{property:"info",header:"Info",size:"small",render:function(e){var t;return r.a.createElement(N.List,{className:"smallList",pad:"xxsmall",primaryKey:"name",secondaryKey:"content",data:[{name:"Level",content:e.level},{name:"Shard",content:null===(t=e.annotations["pregel-id"])||void 0===t?void 0:t.shard},{name:"Step / Superstep",content:e.annotations["phase-step"]+" / "+e.annotations["global-superstep"]},{name:"Phase",content:e.annotations.phase}]})}}],data:b.reports||[]})))))},M={global:{colors:{brand:"#7D4CDB"},font:{family:"Roboto",size:"18px",height:"20px"}}},q=function(e){return r.a.createElement(u.a,Object.assign({tag:"header",direction:"row",align:"center",justify:"between",background:"brand",pad:{left:"medium",right:"small",vertical:"small"},elevation:"medium",style:{zIndex:"1"}},e))};var Q=function(){var e=Object(n.useState)(!0),t=Object(c.a)(e,2),a=t[0],l=t[1];return r.a.createElement(y,null,r.a.createElement(j,null,r.a.createElement(k,null,r.a.createElement(W,null,r.a.createElement(s.a,{theme:M,full:!0},r.a.createElement(d.a.Consumer,null,(function(e){return r.a.createElement(u.a,{fill:!0},r.a.createElement(q,null,r.a.createElement(D,null),r.a.createElement(m.a,{icon:r.a.createElement(b.a,null),onClick:function(){return l(!a)}})),r.a.createElement(g.a,{position:"bottom-left"}),r.a.createElement(u.a,{direction:"row",flex:!0,overflow:{horizontal:"hidden"}},r.a.createElement(u.a,{flex:!0},r.a.createElement(H,null)),a&&"small"===e?r.a.createElement(f.a,null,r.a.createElement(u.a,{background:"light-2",tag:"header",justify:"end",align:"center",direction:"row"},r.a.createElement(m.a,{icon:r.a.createElement(h.a,null),onClick:function(){return l(!1)}})),r.a.createElement(u.a,{fill:!0,background:"light-2",align:"center",justify:"center"},"sidebar")):r.a.createElement(p.a,{direction:"horizontal",open:a},r.a.createElement(u.a,{flex:!0,pad:"small",width:"medium",background:"light-2",elevation:"small"},r.a.createElement(T,null)))))})))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[137,1,2]]]);
//# sourceMappingURL=main.fc71a7a6.chunk.js.map